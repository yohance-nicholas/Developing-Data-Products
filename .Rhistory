lat,
long)
wb_data <- wb_data %>%  left_join(wb_countries,
by = "iso3c")
tidycovid19 <- tidycovid19 %>%  left_join(wb_data,
by = "iso3c")%>%
mutate(active = confirmed - deaths - recovered,
confirmed_logratio = difference(log(confirmed)),
confirmed_per_100k = confirmed/population*100000,
deaths_per_100k = deaths/population*100000,
mortality_rate = deaths/confirmed*100,
recovery_rate = recovered/confirmed*100,
new_cases = confirmed - lag(confirmed),
ave_new_cases = rollmean(new_cases, 7, na.pad=TRUE, align="right"))
# Create Dummy Variables
tidycovid19 <- tidycovid19 %>%
select(region, income) %>%
to_dummy(region, income) %>%
bind_cols(tidycovid19) %>%
select(-contains("region"), contains("region")) %>%
select(-contains("income"), contains("income"))
# Create Filtered Dataset
caricom_tidycovid19 <- tidycovid19 %>%
filter(iso3c %in% caricom) %>%
mutate(economy = if_else(iso3c %in% commodity, "Commodity Based", "Service Based" ),
oecs = if_else(iso3c %in% oecs, "OECS Member State", "Non-OECS Member State" ),
caricom = if_else(iso3c %in% caricom, "CARICOM Member State", "Non-CARICOM Member State" ),
lat = ifelse(iso3c == "DMA", 15.41500, lat),
long = ifelse(iso3c == "DMA", -61.3710, long),
lat = ifelse(iso3c == "KNA", 17.35782, lat),
long = ifelse(iso3c == "KNA", -62.7830, long),
lat = as.numeric(lat),
long = as.numeric(long)) %>%
rename(lng = long)%>%
filter(date >= as.Date("2020-03-07"))
tidycovid19_cases
caricom_tidycovid19_cases <- tidycovid19_cases %>%
filter(iso3c %in% caricom)
caricom_today <- caricom_tidycovid19 %>%
filter(date == max(date))
world_today <- tidycovid19 %>%
filter(date == max(date))
caricom_tidycovid19_cases %>%
group_by(date, cases) %>%
summarise(total_confirmed = sum(confirmed))
caricom_tidycovid19 %>%
group_by(date, cases) %>%
summarise(total_confirmed = sum(confirmed))
caricom_tidycovid19 %>%
group_by(date, confirmed) %>%
summarise(total_confirmed = sum(confirmed))
caricom_tidycovid19 %>%
group_by(date, caricom) %>%
summarise(total_confirmed = sum(confirmed))
caricom_tidycovid19 %>%
group_by(date, caricom) %>%
summarise(total_active = sum(active),
total_deaths = sum(deaths),
total_recovered = sum(recovered))
library(highcharter)
caricom_tidycovid19 %>%
group_by(date, caricom) %>%
summarise(total_active = sum(active),
total_deaths = sum(deaths),
total_recovered = sum(recovered)) %>%
highchart() %>%
hc_chart(type = area) %>%
hc_add_series(total_active)
caricom_totals_ts <- caricom_tidycovid19 %>%
group_by(date, caricom) %>%
summarise(total_active = sum(active),
total_deaths = sum(deaths),
total_recovered = sum(recovered))
View(caricom_totals_ts)
caricom_totals_ts <- caricom_tidycovid19 %>%
group_by(date, caricom) %>%
summarise(total_confirmed = sum(confirmed),
total_active = sum(active),
total_deaths = sum(deaths),
total_recovered = sum(recovered))
caricom_totals_ts
hc <- highchart() %>%
hc_chart(type = "area") %>%
hc_title(text = "Historic and Estimated Worldwide Population Distribution by Region") %>%
hc_subtitle(text = "Source: Wikipedia.org") %>%
hc_xAxis(categories = c("1750", "1800", "1850", "1900", "1950", "1999", "2050"),
tickmarkPlacement = "on",
title = list(enabled = FALSE)) %>%
hc_yAxis(title = list(text = "Percent")) %>%
hc_tooltip(pointFormat = "<span style=\"color:{series.color}\">{series.name}</span>:
<b>{point.percentage:.1f}%</b> ({point.y:,.0f} millions)<br/>",
shared = TRUE) %>%
hc_plotOptions(area = list(
stacking = "percent",
lineColor = "#ffffff",
lineWidth = 1,
marker = list(
lineWidth = 1,
lineColor = "#ffffff"
))
) %>%
hc_add_series(name = "Asia", data = c(502, 635, 809, 947, 1402, 3634, 5268)) %>%
hc_add_series(name = "Africa", data = c(106, 107, 111, 133, 221, 767, 1766)) %>%
hc_add_series(name = "Europe", data = c(163, 203, 276, 408, 547, 729, 628)) %>%
hc_add_series(name = "America", data = c(18, 31, 54, 156, 339, 818, 1201)) %>%
hc_add_series(name = "Oceania", data = c(2, 2, 2, 6, 13, 30, 46))
hc
hc_area <- hchart(caricom_totals_ts,
"area",
hcaes(x = date,
y = total_confirmed))
hc_area
caricom_tidycovid19_cases
hc_area_2 <- caricom_tidycovid19_cases %>%
filter(iso3c == "DMA") %>%
hchart("area",
hcaes(x = date,
y = value,
group = cases))
hc_area_2
# test 1 ------------------------------------------------------------------
hc_area <- hchart(caricom_totals_ts,
"area",
hcaes(x = date,
y = total_confirmed))
hc_area
# test 1 ------------------------------------------------------------------
hc_area <- hchart(caricom_totals_ts,
"area",
hcaes(x = date,
y = total_confirmed)) %>%
hc_title(text = "Breakdown of Confirmed Cases Across CARICOM Member States")
hc_area
# test 1 ------------------------------------------------------------------
hc_area <- hchart(caricom_totals_ts,
"area",
hcaes(x = date,
y = total_confirmed)) %>%
hc_title(text = "Breakdown of Confirmed Cases Across CARICOM Member States") %>%
hc_add_series(name = "Active", data = total_active)
# test 1 ------------------------------------------------------------------
hc_area <- hchart(caricom_totals_ts,
"area",
hcaes(x = date,
y = total_confirmed)) %>%
hc_title(text = "Breakdown of Confirmed Cases Across CARICOM Member States") %>%
hc_add_series(name = "Active", data = caricom_totals_ts$total_active)
hc_area
ggplot_area <- caricom_totals_ts %>%
ggplot(aes(x = date, y = total_active))
ggplot_area
ggplot_area <- caricom_totals_ts %>%
ggplot(aes(x = date, y = total_active)) +
geom_area()
ggplot_area
# Confirmed Cases among CARICOM Member States
caricom_tidycovid19 %>%
filter(date >= as.Date("2020-03-07")) %>%
ggplot(aes(x=date, y=confirmed, fill = country)) +
geom_area() +
labs(x = "Date",
y = "Confirmed Cases",
title = "Cumulative COVID-19 Cases among CARICOM Member States",
caption = "Source: 2019 Novel Coronavirus COVID-19 (2019-nCoV) Data Repository by Johns Hopkins CSSE
Prepared by: Yohance Nicholas")
ggplot_area <- caricom_tidycovid19_cases %>%
filter(iso3c == "TTO") %>%
ggplot(aes(x = date, y = value, fill = cases)) +
geom_area()
ggplot_area
ggplot_area <- caricom_tidycovid19_cases %>%
filter(iso3c == "DMA") %>%
ggplot(aes(x = date, y = value, fill = cases)) +
geom_area()
ggplot_area
ggplot_area <- caricom_tidycovid19_cases %>%
filter(iso3c == "DMA",
value >= 0) %>%
ggplot(aes(x = date, y = value, fill = cases)) +
geom_area()
ggplot_area
View(caricom_totals_ts)
caricom_tidycovid19_cases <- tidycovid19_cases %>%
filter(iso3c %in% caricom)%>%
filter(date >= as.Date("2020-03-07"))
ggplot_area <- caricom_tidycovid19_cases %>%
filter(iso3c == "DMA") %>%
ggplot(aes(x = date, y = value, fill = cases)) +
geom_area()
ggplot_area
ggplot_area <- caricom_tidycovid19_cases %>%
filter(iso3c == "SUR") %>%
ggplot(aes(x = date, y = value, fill = cases)) +
geom_area()
ggplot_area
ggplot_area <- caricom_tidycovid19_cases %>%
filter(iso3c == "HTI") %>%
ggplot(aes(x = date, y = value, fill = cases)) +
geom_area()
ggplot_area
ggplot_area
library(plotly)
ggplotly(ggplot_area)
ggplot_area <- caricom_tidycovid19_cases %>%
filter(iso3c == "HTI") %>%
ggplot(aes(x = date, y = value, fill = cases)) +
labs(title = "Breakdown of Confirmed Cases",
x = "Date",
y = "Total Cases")
geom_area()
ggplot_area <- caricom_tidycovid19_cases %>%
filter(iso3c == "HTI") %>%
ggplot(aes(x = date, y = value, fill = cases)) +
labs(title = "Breakdown of Confirmed Cases",
x = "Date",
y = "Total Cases") +
geom_area()
ggplot_area
library(plotly)
ggplotly(ggplot_area)
hc_area <- caricom_totals_ts %>%
select(-total_confirmed) %>%
gather(cases, value, total_deaths, total_recovered, total_active) %>%
hchart("area", hcaes(x = date, y = value, group = cases)) %>%
hc_title(text = "Breakdown of Confirmed Cases Across CARICOM Member States") %>%
hc_add_series(name = "Active", data = caricom_totals_ts$total_active)
hc_area
View(caricom_tidycovid19_cases)
View(caricom_totals_ts)
View(caricom_totals_ts)
# test 1 ------------------------------------------------------------------
caricom_totals_ts %>%
select(-total_confirmed) %>%
gather(cases, value, total_deaths, total_recovered, total_active)
hc_area <- caricom_totals_ts %>%
select(-total_confirmed) %>%
gather(cases, value, total_deaths, total_recovered, total_active) %>%
hchart("area", hcaes(x = date, y = value, group =cases)) %>%
hc_title(text = "Breakdown of Confirmed Cases Across CARICOM Member States") %>%
hc_add_series(name = "Active", data = caricom_totals_ts$total_active)
hc_area <- caricom_totals_ts %>%
select(-total_confirmed) %>%
gather(cases, value, total_deaths, total_recovered, total_active) %>%
hchart("area", hcaes(x = date, y = value, group =cases)) %>%
hc_title(text = "Breakdown of Confirmed Cases Across CARICOM Member States")
hc_area
hc_area <- caricom_totals_ts %>%
select(-total_confirmed) %>%
gather(cases, value, total_deaths, total_recovered, total_active) %>%
hchart("area",
hcaes(x = date, y = value, group =cases),
plotOptions()) %>%
hc_title(text = "Breakdown of Confirmed Cases Across CARICOM Member States")
hc_area
hc_area <- caricom_totals_ts %>%
select(-total_confirmed) %>%
gather(cases, value, total_deaths, total_recovered, total_active) %>%
hchart("area",
hcaes(x = date, y = value, group =cases)) %>%
hc_title(text = "Breakdown of Confirmed Cases Across CARICOM Member States")
hc_area
hc_area <- caricom_totals_ts %>%
select(-total_confirmed) %>%
gather(cases, value, total_deaths, total_recovered, total_active) %>%
hchart("area",
hcaes(x = date, y = value, group =cases)) %>%
hc_title(text = "Breakdown of Confirmed Cases Across CARICOM Member States")
hc_area
ggplot_area <- caricom_tidycovid19_cases %>%
filter(iso3c == "HTI") %>%
ggplot(aes(x = date, y = value, fill = cases)) +
labs(title = "Breakdown of Confirmed Cases",
x = "Date",
y = "Total Cases") +
geom_area()
ggplot_area
ggplot_area <- caricom_tidycovid19_cases %>%
filter(iso3c == "ATG") %>%
ggplot(aes(x = date, y = value, fill = cases)) +
labs(title = "Breakdown of Confirmed Cases",
x = "Date",
y = "Total Cases") +
geom_area()
ggplot_area
library(plotly)
ggplotly(ggplot_area)
hc_area <- caricom_totals_ts %>%
select(-total_confirmed) %>%
gather(cases, value, total_deaths, total_recovered, total_active) %>%
hchart("area",
hcaes(x = date, y = value, group =cases)) %>%
hc_title(text = "Breakdown of Confirmed Cases Across CARICOM Member States")
hc_area
hc_area <- caricom_totals_ts %>%
select(-total_confirmed) %>%
gather(cases, value, total_deaths, total_recovered, total_active) %>%
hchart("area",
hcaes(x = date, y = value, group =cases)) %>%
hc_title(text = "Breakdown of Confirmed Cases Across CARICOM Member States") %>%
hc_plotOptions(area = list(
stacking = "percent",
lineColor = "#ffffff",
lineWidth = 1,
marker = list(
lineWidth = 1,
lineColor = "#ffffff"
))
)
hc_area
hc_area <- caricom_totals_ts %>%
select(-total_confirmed) %>%
gather(cases, value, total_deaths, total_recovered, total_active) %>%
hchart("area",
hcaes(x = date, y = value, group =cases)) %>%
hc_title(text = "Breakdown of Confirmed Cases Across CARICOM Member States") %>%
hc_plotOptions(area = list(
stacking = "normal",
lineColor = "#ffffff",
lineWidth = 1,
marker = list(
lineWidth = 1,
lineColor = "#ffffff"
))
)
hc_area
hc_area <- caricom_totals_ts %>%
select(-total_confirmed) %>%
gather(cases, value, total_deaths, total_recovered, total_active) %>%
hchart("area",
hcaes(x = date, y = value, group =cases)) %>%
hc_title(text = "Breakdown of Confirmed Cases Across CARICOM Member States") %>%
hc_plotOptions(area = list(
stacking = "normal",
lineColor = "#ffffff",
lineWidth = 1,
marker = list(
lineWidth = 1,
lineColor = "#ffffff"
))
) %>% hc_add_theme(hc_theme_ft())
hc_area
hc_area <- caricom_totals_ts %>%
select(-total_confirmed) %>%
gather(cases, value, total_deaths, total_recovered, total_active) %>%
hchart("area",
hcaes(x = date, y = value, group =cases)) %>%
hc_title(text = "Breakdown of Confirmed Cases Across CARICOM Member States") %>%
hc_plotOptions(area = list(
stacking = "normal",
lineColor = "#ffffff",
lineWidth = 1,
marker = list(
lineWidth = 1,
lineColor = "#ffffff"
))
) %>% hc_add_theme(hc_theme_smpl())
hc_area
hc_area <- caricom_totals_ts %>%
select(-total_confirmed) %>%
gather(cases, value, total_deaths, total_recovered, total_active) %>%
hchart("area",
hcaes(x = date, y = value, group =cases)) %>%
hc_title(text = "Breakdown of Confirmed Cases Across CARICOM Member States") %>%
hc_plotOptions(area = list(
stacking = "normal",
lineColor = "#ffffff",
lineWidth = 1,
marker = list(
lineWidth = 1,
lineColor = "#ffffff"
))
) %>% hc_add_theme(hc_theme_elementary())
hc_area
hc_area <- caricom_totals_ts %>%
select(-total_confirmed) %>%
gather(cases, value, total_deaths, total_recovered, total_active) %>%
hchart("area",
hcaes(x = date, y = value, group =cases)) %>%
hc_title(text = "Breakdown of Confirmed Cases Across CARICOM Member States") %>%
hc_plotOptions(area = list(
stacking = "normal",
lineColor = "#ffffff",
lineWidth = 1,
marker = list(
lineWidth = 1,
lineColor = "#ffffff"
))
) %>% hc_add_theme(hc_theme_google())
hc_area
hc_add_theme(hc_theme_smpl())
hc_add_theme(hc_theme_smpl())
hc_area <- caricom_totals_ts %>%
select(-total_confirmed) %>%
gather(cases, value, total_deaths, total_recovered, total_active) %>%
hchart("area",
hcaes(x = date, y = value, group =cases)) %>%
hc_title(text = "Breakdown of Confirmed Cases Across CARICOM Member States") %>%
hc_plotOptions(area = list(
stacking = "normal",
lineColor = "#ffffff",
lineWidth = 1,
marker = list(
lineWidth = 1,
lineColor = "#ffffff"
))
) %>% hc_add_theme(hc_theme_smpl())
hc_area
hc_area <- caricom_totals_ts %>%
select(-total_confirmed) %>%
gather(cases, value, total_deaths, total_recovered, total_active) %>%
hchart("area",
hcaes(x = date, y = value, group =cases)) %>%
hc_title(text = "Breakdown of Confirmed Cases Across CARICOM Member States") %>%
hc_plotOptions(area = list(
stacking = "normal")
) %>% hc_add_theme(hc_theme_smpl())
hc_area
,
lineColor = "#ffffff",
lineWidth = 1,
marker = list(
lineWidth = 1,
lineColor = "#ffffff"
)
hc_area
# test 1 ------------------------------------------------------------------
caricom_totals_ts %>%
select(-total_confirmed) %>%
gather(cases, value, total_deaths, total_recovered, total_active)
hc_area <- caricom_totals_ts %>%
select(-total_confirmed) %>%
gather(cases, value, total_deaths, total_recovered, total_active) %>%
hchart("area",
hcaes(x = date, y = value, group =cases)) %>%
hc_title(text = "Breakdown of Confirmed Cases Across CARICOM Member States") %>%
hc_plotOptions(area = list(
stacking = "normal",
lineColor = "#ffffff",
lineWidth = 1,
marker = list(
lineWidth = 1,
lineColor = "#ffffff"
))
) %>% hc_add_theme(hc_theme_smpl())
hc_area
ggplot_area <- caricom_tidycovid19_cases %>%
filter(iso3c == "ATG") %>%
ggplot(aes(x = date, y = value, fill = cases)) +
labs(title = "Breakdown of Confirmed Cases",
x = "Date",
y = "Total Cases") +
geom_area()
ggplot_area
library(plotly)
ggplotly(ggplot_area)
source('~/GitHub/Developing-Data-Products/0. Data Cleaning Scripts/0_tidycovid19_caricom_local.R', echo=TRUE)
source('~/GitHub/Developing-Data-Products/0. Data Cleaning Scripts/0_tidycovid19_caricom_local.R', echo=TRUE)
View(by_caricom)
source('~/GitHub/Developing-Data-Products/0. Data Cleaning Scripts/0_tidycovid19_caricom_local.R', echo=TRUE)
source('~/GitHub/Developing-Data-Products/0_refresh_repo.R')
source('~/GitHub/Developing-Data-Products/0_refresh_repo.R')
source('~/GitHub/Developing-Data-Products/0_refresh_repo.R')
source('~/GitHub/Developing-Data-Products/0_refresh_repo.R')
source('~/GitHub/Developing-Data-Products/0_refresh_repo.R')
install.packages(c("backports", "fable", "fabletools", "feasts", "ggplot2", "glmnet", "htmltools", "labelled", "rmarkdown", "V8"))
source('~/GitHub/Developing-Data-Products/0_refresh_repo.R')
rlang::last_error()
# CARICOM Covid Data Cleaning Script For Loca Data Refresh
# Prepared by Yohance Nicholas
# Version: May 28th 2020
setwd("~/GitHub/Developing-Data-Products")
library(tidyverse)
library(tsibble)
library(tidyr)
library(sjmisc)
library(zoo) # for rollmean()
# Create ISO3C Variables --------------------------------------------------
commodity <- c("GUY", "JAM", "TTO") # To create variable which identifies type of economy
oecs <- c("ATG", "DMA", "GRD", "KNA", "LCA", "VCT") # To create variable which identifies OECS Member States
caricom <- c("ATG","BHS","BLZ","BRB","DMA","GRD","GUY","HTI","JAM","KNA","LCA","SUR","TTO","VCT") # To create variable which identifies CARICOM Member States
# Import COVID-19 Data ----------------------------------------------------
tidycovid19 <- readRDS(gzcon(url("https://git.io/JfYa7"))) %>%
drop_na(confirmed)
tidycovid19_cases <- tidycovid19 %>%
select(iso3c,
country,
date,
confirmed,
deaths,
recovered) %>%
mutate(active = confirmed - deaths - recovered) %>%
select(-confirmed) %>%
gather(cases, value, deaths, recovered, active)
# Add Spatial Coordinates
library(wbstats)
series <- c("ST.INT.ARVL","SP.POP.0014.TO.ZS", "SP.POP.1564.TO.ZS", "SP.POP.65UP.TO.ZS", "SH.STA.DIAB.ZS", "SH.DTH.NCOM.ZS", "SH.DYN.NCOM.ZS")
wb_data <- wb(indicator = series,
mrv = 1) %>%
select(iso3c, value, indicatorID) %>%
spread(indicatorID, value) %>%
rename(tourist_arrivals = ST.INT.ARVL,
pop_0_14_2018 = SP.POP.0014.TO.ZS,
pop_15_64_2018 = SP.POP.1564.TO.ZS,
pop_65_over_2018 = SP.POP.65UP.TO.ZS,
diabetes_20_79 = SH.STA.DIAB.ZS,
death_by_ncd = SH.DTH.NCOM.ZS,
death_by_cvd_ca_dm_30_70 = SH.DYN.NCOM.ZS)
source('~/GitHub/Developing-Data-Products/0_refresh_repo.R')
source('~/GitHub/Developing-Data-Products/0_refresh_repo.R')
source('~/GitHub/Developing-Data-Products/0_refresh_repo.R')
source('~/GitHub/Developing-Data-Products/0_refresh_repo.R')
source('~/GitHub/Developing-Data-Products/0_refresh_repo.R')
